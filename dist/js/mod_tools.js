!function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=30)}({30:function(e,t){window.ModTools={elements:{bubbleContainer:$(".bubble-container"),screenshotDiv:$("<div>",{class:"bubble"}).append($("<a>",{id:"download",onclick:"App.toURL()"}).text("Screenshot")),spamEnabledDiv:$("<div>",{class:"bubble"}).text("Spam Enabled: false"),restrictedToggle:$("<div>",{class:"bubble restricted-toggle"}).text("Show Restricted Areas"),permaReticule:$("<div>",{class:"reticule"}).hide(),restrictionDiv:$("<div>",{class:"bubble"}).text("Create Restriction"),exitSelectionMode:$("<div>",{class:"bubble"}).text("Exit Selection Mode"),startSelection:$("<div>",{class:"bubble",text:"Start Position"}),endSelection:$("<div>",{class:"bubble",text:"End Position"}),confirmSelection:$("<div>",{class:"bubble",text:"Confirm Selection"}).hide(),selectionBorder:$("<div>",{class:"selection"})},enableRestrictions:!1,init:function(){$(".restricted-toggle").length&&(this.enableRestrictions=!0),this.reset(),this.initContextMenu(),this.initSpamBlocks(),this.initPermaReticule(),this.initSelectionMode(),App.alert("Moderation tools loaded"),setTimeout(function(){App.alert(null)},1500)},reset:function(){this.spamBlocksEnabled=!1,this.selectionModeEnabled=!1,this.manualStart=!1,this.manualEnd=!1,this.startSelection=null,this.endSelection=null,this.elements.spamEnabledDiv.text("Spam Enabled: false"),this.elements.startSelection.text("Start Position"),this.elements.endSelection.text("End Position"),this.elements.confirmSelection.hide(),this.initBubbles(),this.initCreateRestriction(),this.onTransform(),App.switchColor(null),App.elements.palette.show(),this.elements.permaReticule.hide()},initPermaReticule:function(){$(".ui").append(this.elements.permaReticule);var e=function(e){var t=App.screenToBoardSpace(e.clientX,e.clientY);t.x|=0,t.y|=0;var n=App.boardToScreenSpace(t.x,t.y);this.elements.permaReticule.css("transform","translate("+n.x+"px, "+n.y+"px)"),this.elements.permaReticule.css("width",App.scale+"px").css("height",App.scale+"px")};App.elements.board.on("wheel",e.bind(this)),App.elements.board.on("mousemove",e.bind(this))},initSelectionMode:function(){var e=this;$(".ui").append(this.elements.selectionBorder),App.elements.board.on("mousemove",this.onTransform.bind(this)),App.elements.boardContainer.on("wheel",this.onTransform.bind(this)),App.elements.boardContainer.on("mousedown",function(e){downX=e.clientX,downY=e.clientY}).on("click",function(t){if(e.selectionModeEnabled&&downX===t.clientX&&downY===t.clientY){if(null===e.startSelection&&!e.manualEnd||e.manualStart){var n=App.screenToBoardSpace(t.clientX,t.clientY);if(null!==e.endSelection&&(n.x>e.endSelection.x||n.y>e.endSelection.y))return e.manualStart=!1,e.endSelection=n,void e.elements.endSelection.text("Start: ("+e.endSelection.x+", "+e.endSelection.y+")");e.startSelection=n,e.elements.startSelection.text("Start: ("+e.startSelection.x+", "+e.startSelection.y+")")}else{var n=App.screenToBoardSpace(t.clientX,t.clientY);if(n.x<e.startSelection.x||n.y<e.startSelection.y)return e.manualStart=!0,e.startSelection=n,void e.elements.startSelection.text("Start: ("+e.startSelection.x+", "+e.startSelection.y+")");e.endSelection=n,e.elements.endSelection.text("End: ("+e.endSelection.x+", "+e.endSelection.y+")"),null===e.startSelection&&e.manualEnd&&(e.manualEnd=!1,e.manualStart=!0)}null!==e.startSelection&&null!==e.endSelection&&e.elements.confirmSelection.show()}})},onTransform:function(){if(this.selectionModeEnabled&&null!==this.startSelection&&null!==this.endSelection){var e=(this.endSelection.x-(this.startSelection.x-1))*App.scale,t=(this.endSelection.y-(this.startSelection.y-1))*App.scale,n=App.boardToScreenSpace(this.startSelection.x,this.startSelection.y);this.elements.selectionBorder.css("transform","translate("+n.x+"px, "+n.y+"px)"),this.elements.selectionBorder.css("width",e+"px").css("height",t+"px"),this.elements.selectionBorder.show()}else this.elements.selectionBorder.hide()},initBubbles:function(){this.elements.bubbleContainer.empty(),this.elements.bubbleContainer.append(this.elements.screenshotDiv),this.elements.bubbleContainer.append(this.elements.spamEnabledDiv),this.enableRestrictions&&(this.elements.bubbleContainer.append(this.elements.restrictionDiv),App.elements.restrictedToggle=this.elements.restrictedToggle,this.elements.bubbleContainer.append(this.elements.restrictedToggle),this.elements.restrictedToggle.click(App.restrictedAreaToggle.bind(App)))},initSpamBlocks:function(){var e=this;App.elements.board.on("mousemove",function(t){var n=App.screenToBoardSpace(t.clientX,t.clientY);e.spamBlocksEnabled&&App.place(n.x,n.y)}),$(document).on("mousedown",function(t){2===t.which&&(e.spamBlocksEnabled=!e.spamBlocksEnabled,e.elements.spamEnabledDiv.text("Spam Enabled: "+e.spamBlocksEnabled),t.preventDefault())})},initCreateRestriction:function(){var e=this;this.elements.restrictionDiv.click(function(){e.startSelectionMode(function(t,n){e.restrictSelection(t,n),e.reset()})})},startSelectionMode:function(e){var t=this;this.reset(),App.elements.palette.hide(),this.elements.permaReticule.show(),this.elements.bubbleContainer.empty(),this.elements.bubbleContainer.append(this.elements.exitSelectionMode),this.elements.bubbleContainer.append(this.elements.startSelection),this.elements.bubbleContainer.append(this.elements.endSelection),this.elements.bubbleContainer.append(this.elements.confirmSelection),this.elements.startSelection.click(function(){t.elements.startSelection.text("Start Position"),t.manualStart=!0,t.manualEnd=!1,t.elements.confirmSelection.hide()}),this.elements.endSelection.click(function(){t.manualStart=!1,t.manualEnd=!0}),this.elements.exitSelectionMode.click(function(){t.reset()}),this.elements.confirmSelection.click(function(){e(t.startSelection,t.endSelection)}),this.selectionModeEnabled=!0},restrictSelection:function(e,t){App.socket.emit("restriction",{start:e,end:t})},initContextMenu:function(){$.contextMenu("destroy"),["right","left"].forEach(function(e){$.contextMenu({selector:".username",trigger:e,zIndex:1e3,autoHide:!0,items:{spectate:{name:"Spectate",callback:function(e,t){App.spectate(t.$trigger.text())}},mention:{name:"Mention",callback:function(e,t){App.mention(t.$trigger.text())}},sep1:"",cooldown:{name:"Cooldown",callback:function(e,t){App.socket.emit("cooldown",t.$trigger.text())}},ban:{name:"Ban",callback:function(e,t){App.socket.emit("ban",t.$trigger.text())}}}})})}},ModTools.init()}});